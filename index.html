<!DOCTYPE html>
<html>

<head>
    <title>我的后台管理</title>
    <meta charset="utf-8">
    <!-- 360极速模式 -->
    <meta name="renderer" content="webkit">
    <!-- 最新ie和谷歌优先渲染 -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <!-- 为移动设备添加 viewport -->
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <!-- 禁止缓存 -->
    <meta http-equiv=”pragma” content=”no-cache”>
    <meta http-equiv=”cache-control” content=”no-cache”>
    <meta http-equiv=”expires” content=”0″>
    <link rel="stylesheet" href="layui/css/layui.css" media="all">
    <link rel="stylesheet" href="css/Allscrollbar.css" media="all">
    <link rel="stylesheet" href="css/index.css" media="all">
</head>

<body>
  <div class="layui-layout layui-layout-admin" id="indexApp">
    <!-- header -->
    <div class="layui-header header header-demo" style="background: #393d49;">
      <div class="layui-main dis-head" style="margin: 0px 5px;">
        <a href="javascript:;" class="logo"><img src="image/tf_logo.png" alt=""></a>
        <div class="dis-head">
          <label class="company-name">天峰酷钉科技有限公司</label>
          <a href="javascript:;" class="layui-btn layui-btn-warm layui-btn-xs">已认证</a>
        </div>
        <ul class="layui-nav nav-myset">
          <li class="layui-nav-item">
            <a href="javascript:;" :data-isrc="1" v-on:click="changeIframeSrc"><i class="layui-icon">&#xe667;</i>通知</a>
          </li>
          <li class="layui-nav-item">
            <a href="javascript:;" :data-isrc="2" v-on:click="changeIframeSrc"><i class="layui-icon">&#xe63a;</i>在线咨询</a>
          </li>
          <li class="layui-nav-item">
            <a href="javascript:;" :data-isrc="3" v-on:click="changeIframeSrc"><i class="layui-icon">&#xe60a;</i>使用指南</a>
          </li>
          <li class="layui-nav-item">
            <a href="javascript:;" :data-isrc="4" v-on:click="changeIframeSrc"><img src="image/phone.png" alt="">电话咨询:40019388434</a>
          </li>
          <li class="layui-nav-item">
            <a href="javascript:;" :data-isrc="5" v-on:click="changeIframeSrc"><i class="layui-icon">&#xe66f;</i>用户账户</a>
          </li>
        </ul>
      </div>
    </div>
    <!-- aside -->
    <div class="layui-side layui-bg-black dis-head asid-column" id="thisaside">
        <ul class="layui-nav layui-nav-tree layui-inline nav-reset" style="margin-right: 10px;" v-html="navstr">
        </ul>
        <div class="asid-fooder dis-head asid-column jc-center">
          <div class="dis-head af-top">
            <div style="flex: 1"><img src="image/kefu.png" width="48" alt=""></div>
            <div style="flex: 1">
              <div class="cust-help">客户支持</div>
              <div class="call-me" style="margin: 0">电话咨询:40018374844</div>
            </div> 
          </div>

          <div class="af-top call-me">
            工作时间：周一至周日 8:30-18:00
          </div>  
        </div>
    </div>
    <!-- content -->
    <div class="layui-tab layui-tab-brief" lay-filter="demoTitle">
        <div class="layui-body site-demo site-demo-body" style="bottom: 0" id="thisContent">
            <iframe :src="iframeSrc"></iframe>
        </div>
    </div>
  </div>
<!-- popup -->
<!-- <div class="popupfixed" style="display: none;" id="popup_block">
    <div class="p-relativecont">
        <div class="layui-layer layui-layer-dialog p-absolutecont" style="left: 50%;top: 50%;transform: translate(-50%,-50%);">
            <div class="layui-layer-title">
                <span id="pop_title"></span>
                <span class="layui-layer-setwin"><a class="layui-layer-ico layui-layer-close layui-layer-close1" href="javascript:;" id="closepop"></a></span>
            </div>
            <div class="layui-layer-content" id="pop_Content" style="max-height: 300px;overflow-y: auto;">
            </div>
            <div class="layui-layer-btn layui-layer-btn-c">
                <a class="layui-btn layui-btn-primary" id="whitebtn" style="height: 30px;">取消</a>
                <a class="layui-layer-btn0"  id="universalbtn">确认</a>
            </div>
        </div>
    </div>
</div> -->
  <script type="text/javascript" src="js/jquery-3.2.1.min.js"></script>
  <!-- <script type="text/javascript" src="https://g.alicdn.com/dingding/dingtalk-pc-api/2.7.0/index.js"></script> -->
  <script type="text/javascript" src="layui/layui.js"></script>
  <script type="text/javascript" src="js/vue.min.js"></script>
  <script type="text/javascript" src="js/jquery-hou-main.js"></script>
  <script type="text/javascript">
    var obj = null;
    $(document).ready(function() {
      layui.use(['element','layer'],function(){
        let ele = layui.element;
        let app = new Vue({
          el:'#indexApp',
          data:{
            indexObj:{
              userName:'test',
              userID:'test',
              position:'test'
            },
            iframeSrc:'ChildFrameHTML/home.html',//默认页面
            nav:[
              { name:'首页', icon:'image/home.png', src:'ChildFrameHTML/Xing/',id:0, child:[]},
              { name:'资产管理', icon:'image/moneyMa.png', src:'test',id:1, 
                child:[
                  {name:'酒店餐饮',src:'test',id:2,child:[]},
                  {name:'交通运输',src:'test',id:3,
                    child:[
                      {name:'交通',src:'test',id:4,child:[]},
                      {name:'运输',src:'test',id:5,child:[
                        {name:'空运',src:'test',id:15,child:[
                          {name:'直升机',src:'test',id:18,child:[]},
                          {name:'运输机',src:'test',id:19,child:[]},
                        ]},
                        {name:'陆运',src:'test',id:16,child:[]},
                        {name:'海运',src:'test',id:17,child:[]}
                      ]}
                    ]},
                  {name:'交通运输',src:'test',id:3,
                    child:[
                      {name:'交通',src:'test',id:4,child:[]},
                      {name:'运输',src:'test',id:5,child:[
                        {name:'空运',src:'test',id:15,child:[
                          {name:'直升机',src:'test',id:18,child:[]},
                          {name:'运输机',src:'test',id:19,child:[]},
                        ]},
                        {name:'陆运',src:'test',id:16,child:[]},
                        {name:'海运',src:'test',id:17,child:[]}
                      ]}
                  ]},
                  {name:'酒吧KTV',src:'test',id:6,child:[]},
                  {name:'煤矿金属',src:'test',id:7,child:[]}
              ]},
              { name:'系统设置', icon:'image/set.png', src:'test',id:8, 
                child:[
                  {name:'音频设置',src:'test',id:9,child:[]},
                  {name:'音频设置',src:'test',id:10,
                    child:[
                      {name:'左声道',src:'test',id:11,child:[]},
                      {name:'右声道',src:'test',id:12,child:[]}
                    ]},
                  {name:'酒吧KTV',src:'test',id:13,child:[]},
                  {name:'煤矿金属',src:'test',id:14,child:[]}
              ]},
            ],
            navstr:'',//导航栏
          },
          created:function(){
            this.getNav(this.nav);
<<<<<<< HEAD
            // alert(document.location.href)
=======
            alert(document.location.href)
>>>>>>> 36e1e1989b526d590d137305220750b08f87eed1
            // console.log(123)
            console.log(document.location.href)
            // console.log(this.navstr)
          },
          mounted:function(){
            ele.render();
            let that = this;
            $('.linkFrame').click(function(event) {
              that.iframeSrc = $(this).attr('data-isrc');
              // console.log($(this).attr('data-isrc'))
            });
          },
          methods:{
            //侧边栏之外的跳转
            changeIframeSrc:function(e){
              this.iframeSrc = e.target.dataset.isrc;
            },
            //获取侧边栏
            getNav:function(arr){
              for (var i = 0; i < arr.length; i++) {
                var liEle = document.createElement('li');
                liEle.className = 'layui-nav-item';
                // let item = '<a href="javascript" data-isrc="'+arr[i].src+'" data-id="'+arr[i].id+'">arr[i].name</a>';
                if(arr[i].child.length!=0){
                  liEle.innerHTML = '<a href="javascript:;" data-isrc="'+arr[i].src+'" data-id="'+arr[i].id+'"><img src="'+arr[i].icon+'" width="20" style="margin-right:15px;"/>'+arr[i].name+'</a>';  
                  var lisDlEle = document.createElement('dl');
                  lisDlEle.className = 'layui-nav-child';
                  this.getNavChild(arr[i].child,lisDlEle);
                  liEle.appendChild(lisDlEle);
                }else{
                  liEle.innerHTML ='<a href="javascript:;" data-isrc="'+arr[i].src+'" data-id="'+arr[i].id+'" class="linkFrame"><img src="'+arr[i].icon+'" width="20" style="margin-right:15px;"/>'+arr[i].name+'</a>';
                }
                // console.log(liEle.innerHTML)
                this.navstr+=this.domToString(liEle);
              }
            },
            //侧边无限级子栏目
            getNavChild:function(arr,dlElement){
              for (var i = 0; i < arr.length; i++) {
                var ddEle = document.createElement('dd');
                if(arr[i].child.length!=0){
                  ddEle.innerHTML = '<a href="javascript:;" data-isrc="'+arr[i].src+'" data-id="'+arr[i].id+'">'+arr[i].name+'</a>';
                  var dlEle = document.createElement('dl');
                  dlEle.className = 'layui-nav-child';
                  ddEle.appendChild(dlEle);
                  this.getNavChild(arr[i].child,dlEle);
                }else{
                  ddEle.innerHTML = '<a href="javascript:;" data-isrc="'+arr[i].src+'" data-id="'+arr[i].id+'" class="linkFrame">'+arr[i].name+'</a>';
                }
                dlElement.append(ddEle);
              }
            },
            //dom转换成String
            domToString:function (doms) {  
              let tmpNode = document.createElement('div')
              tmpNode.appendChild(doms) 
              let str = tmpNode.innerHTML
              tmpNode = doms = null; // 解除引用，以便于垃圾回收  
              return str;  
            }
          },
        });
        obj = app;
      });
    });
              //获取code
              // $(document).ready(function() {            
              //     layui.use(['layer','element'], function() {
              //         var layer = layui.layer,element = layui.element;
              //         var loadAnim = layer.load();
              //         var gdn = getDomainName();
              //     //请求code
              //     DingTalkPC.runtime.permission.requestAuthCode({
              //         corpsrc:'test',Id: "dingdbadd1f3abdc696235c2f4657eb6378f", //企业ID 
              //         onSuccess: function(result) {
              //             let data = { authCode: result.code };
              //             RequestPersonData(data);
              //         },
              //         onFail: function(err) {
              //             //获取code失败 跳转页面 -不可返回
              //             layer.close(loadAnim);
              //             layer.msg('错误8888，请联系管理员！', {icon: 2,time:1500}, function(){
              //               location.replace('error.html');
              //             });  
              //         }
              //     });
              //     //请求个人信息
              //     function RequestPersonData(data) {
              //         const url = `${gdn}/homeController/getUserInformation`;
              //         $hou.GetApi(url, data, function(state, res) {
              //             if (state) {
              //                 index_config.setHeadImg(res.result.avatar);
              //                 index_config.setMyName(res.result.userName);
              //                 index_config.setMyPosition(res.result.position);
              //                 index_config.setMyGroup(res.result.userDepartment);
              //                 index_config.users = res.result;
              //                 // $hou.clearLs();
              //                 userData = res.result;
              //                 setNavAside(res.result.userId);
              //                 // GetNav(function(res){
              //                 //     // setNavAside(res.result.userId);
              //                 //     index_config.setAsideNav(res);
              //                 //     index_config.setDefaultHome(res.result[0].pages, res.result[0].id, res.result[0].navTitle);
              //                 //     index_config.initAside();
              //                 //     layer.closeAll();
              //                 // });
              //                 // layer.closeAll();
              //                 // setNavAside(res.result.userId);
              //             } else {
              //                 layer.closeAll();
              //                 layer.msg(res.code,{icon:2,time:1500});
              //             }
              //         });
              //     }
              //     //请求导航栏信息
              //     function setNavAside(userid){
              //         let data = {usersrc:'test',Id:userid};
              //         let url = `${gdn}/navigationTableController/getUserNavAll`;
              //         $hou.GetApi(url,data,function(state,res){
              //             if (state) { 
              //                 // console.log(res);
              //                 //设置导航栏
              //                 index_config.setAsideNav(res);
              //                 //设置默认首页信息 参数 url,id,title
              //                 index_config.setDefaultHome(res.result[0].pages, res.result[0].id, res.result[0].navTitle);
              //                 //加载页面侧边栏和Tab配置
              //                 index_config.initAside();
              //                 //
              //                 layer.closeAll();
              //             }else{
              //                 layer.close(loadAnim);
              //                 layer.msg('您没有操作权限，请联系管理员！', {icon: 2,time:1500}, function(){
              //                   location.replace('error.html');
              //                 });  
              //             }
              //         });
              //     }
              //     index_config.initNav({
              //         CompanyName: '荣信人事后台管理系统'
              //     });
              //     //隐藏logo
              //     index_config.hideLogo();
              //     //回调用户信息
              //     function ResultUser(user){
              //         let users = userData;
              //         user(users);
              //     }
              // }); 
  // });
  </script>
</body>

</html>